version: 1
frontend:
  phases:
    install:
      runtime-versions:
        php: 8.3
    preBuild:
      commands:
        - yum install -y php-cli php-zip wget unzip
        - php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
        - php composer-setup.php --install-dir=/usr/local/bin --filename=composer
        - composer install --no-dev --optimize-autoloader
        - npm install
    build:
      commands:
        - npm run build
        - php artisan filament:upgrade
        - php artisan config:cache
        - php artisan route:cache
  artifacts:
    baseDirectory: public
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - vendor/**/*
